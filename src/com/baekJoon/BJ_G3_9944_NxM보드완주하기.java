package com.baekJoon;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.StringReader;
import java.util.Arrays;
import java.util.StringTokenizer;

public class BJ_G3_9944_NxM보드완주하기 {
	static BufferedReader input = new BufferedReader(new InputStreamReader(System.in));
	static StringTokenizer tokens;
	static int T,N,M,points,min;
	static char map[][];
	static boolean isVisited[][];
	public static void main(String[] args) throws NumberFormatException, IOException {
		input = new BufferedReader(new StringReader(src));
		String line = null;
		int T = 1; 
		while((line = input.readLine()) != null) { // 이런 구문이 되는구나..
			tokens = new StringTokenizer(line);
			N = Integer.parseInt(tokens.nextToken());
			M = Integer.parseInt(tokens.nextToken());
			map = new char[N][M];
			isVisited = new boolean[N][M];
			min = Integer.MAX_VALUE;
			points = 0;
			
			for(int r=0; r<N; r++) {
				String ln = input.readLine();
				for(int c=0; c<M; c++) {
					map[r][c] = ln.charAt(c);
					if(map[r][c] == '.') {
						points++;
					}
				}	
			}
//			System.out.println("points : "+points);
			for(int r=0; r<N; r++) {
				for(int c=0; c<M; c++) {
					if(map[r][c] == '.') {
						for(int d=0; d<4; d++) {
							isVisited[r][c] = true;
							dfs(r,c,d,1,1);
//						System.out.println("--------------------------------------------");
							isVisited[r][c] = false;
						}
					}
				}	
			}
			
//			for(char x[] : map) {
//				System.out.println(Arrays.toString(x));
//			}
			if(points == 1) {
				System.out.println("Case "+T+": 0");
			}else {
				if(min == Integer.MAX_VALUE) {
					System.out.println("Case "+T+": -1");
				}else {
					System.out.println("Case "+T+": "+min);
				}
			}
			T++;
			
		}
	}

	private static void dfs(int r, int c, int dir, int cnt, int depth) {
		if(depth == points) {
//			System.out.println("r : "+r+",  "+"c : "+c+",  "+"dir : "+dir+",  "+"cnt : "+cnt+",  "+"depth : "+depth);
			if(min > cnt) {
				min = cnt;
			}
			return;
		}
//		System.out.println("r : "+r+",  "+"c : "+c+",  "+"dir : "+dir+",  "+"cnt : "+cnt+",  "+"depth : "+depth);
		int nr = r + dr[dir];
		int nc = c + dc[dir];
		if(isIn(nr, nc) && !isVisited[nr][nc] && map[nr][nc]=='.') {
			isVisited[nr][nc] = true;
			dfs(nr, nc, dir, cnt, depth+1);
			isVisited[nr][nc] = false;
		}else { // 꺽어야 할 때
			for(int d=0; d<4; d++) {
				int nnr = r + dr[d];
				int nnc = c + dc[d];
				if(isIn(nnr, nnc) && !isVisited[nnr][nnc] && map[nnr][nnc] == '.') {
					isVisited[nnr][nnc] = true;
					dfs(nnr, nnc, d, cnt+1, depth+1);
					isVisited[nnr][nnc] = false;
				}
			}
		}
	}
	
	static int dr[] = {-1,1,0,0}; // 상하좌우
	static int dc[] = {0,0,-1,1};
	
	static boolean isIn(int r, int c) {
		return (r>=0 && c>=0 && r<N && c<M);
	}
	static String src =
			"5 5\r\n" + 
			"**...\r\n" + 
			".....\r\n" + 
			"....*\r\n" + 
			"..*..\r\n" + 
			".....\r\n" + 
			"5 5\r\n" + 
			"*....\r\n" + 
			"..*..\r\n" + 
			"....*\r\n" + 
			".....\r\n" + 
			"...*.\r\n" + 
			"5 5\r\n" + 
			"*....\r\n" + 
			"*....\r\n" + 
			"*....\r\n" + 
			"....*\r\n" + 
			"....*\r\n" + 
			"6 6\r\n" + 
			"*.....\r\n" + 
			"..*...\r\n" + 
			"......\r\n" + 
			"...*..\r\n" + 
			"......\r\n" + 
			"*.....\r\n" + 
			"6 6\r\n" + 
			"*.....\r\n" + 
			"......\r\n" + 
			".*...*\r\n" + 
			"......\r\n" + 
			"....*.\r\n" + 
			"*.....\r\n" + 
			"6 6\r\n" + 
			"......\r\n" + 
			".**...\r\n" + 
			"....*.\r\n" + 
			"....*.\r\n" + 
			"......\r\n" + 
			"..*..*\r\n" + 
			"7 7\r\n" + 
			".......\r\n" + 
			".....*.\r\n" + 
			"..**...\r\n" + 
			".......\r\n" + 
			"..*....\r\n" + 
			"....*..\r\n" + 
			".......\r\n" + 
			"7 7\r\n" + 
			"*......\r\n" + 
			"*......\r\n" + 
			".......\r\n" + 
			".*.*...\r\n" + 
			".......\r\n" + 
			"..*....\r\n" + 
			".......\r\n" + 
			"7 7\r\n" + 
			".......\r\n" + 
			"...*...\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"....**.\r\n" + 
			"....*..\r\n" + 
			"......*\r\n" + 
			"7 7\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"*******\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"7 7\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"*.*.*.*\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"7 7\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"....*..\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"7 7\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"......*\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"7 7\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			".......\r\n" + 
			"......*\r\n" + 
			"7 7\r\n" + 
			"*******\r\n" + 
			"*******\r\n" + 
			"*******\r\n" + 
			"***.***\r\n" + 
			"*******\r\n" + 
			"*******\r\n" + 
			"*******\r\n" + 
			"7 7\r\n" + 
			"*******\r\n" + 
			"*******\r\n" + 
			"*******\r\n" + 
			".......\r\n" + 
			"*******\r\n" + 
			"*******\r\n" + 
			"*******\r\n" + 
			"10 10\r\n" + 
			"..........\r\n" + 
			".****.....\r\n" + 
			".****.....\r\n" + 
			".****.....\r\n" + 
			".****.....\r\n" + 
			".****.....\r\n" + 
			".*****....\r\n" + 
			".*****....\r\n" + 
			".*****....\r\n" + 
			"..........\r\n" + 
			"10 10\r\n" + 
			".........*\r\n" + 
			"......*..*\r\n" + 
			"..***.*..*\r\n" + 
			"..***....*\r\n" + 
			"..****...*\r\n" + 
			"..****...*\r\n" + 
			"..****...*\r\n" + 
			"..****...*\r\n" + 
			".........*\r\n" + 
			".........*\r\n" + 
			"10 10\r\n" + 
			"*.....****\r\n" + 
			"..***.****\r\n" + 
			"..*.......\r\n" + 
			"..*.......\r\n" + 
			"..*..*****\r\n" + 
			"..*..*****\r\n" + 
			"..*..*****\r\n" + 
			"..*.......\r\n" + 
			"..*.*****.\r\n" + 
			"..*.......\r\n" + 
			"15 15\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			".......*.......\r\n" + 
			".........*.....\r\n" + 
			".........*.....\r\n" + 
			".........*.....\r\n" + 
			".........*.....\r\n" + 
			".........*.....\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"15 15\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			".......*.......\r\n" + 
			".......*.......\r\n" + 
			".......*....*..\r\n" + 
			"............*..\r\n" + 
			"...******...*..\r\n" + 
			"...............\r\n" + 
			"...........*...\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"...............\r\n" + 
			"30 30\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"....*******************.......\r\n" + 
			"..............................\r\n" + 
			"...***********************....\r\n" + 
			"..............................\r\n" + 
			"....***********************...\r\n" + 
			"....***********************...\r\n" + 
			"....***********************...\r\n" + 
			"....***********************...\r\n" + 
			"....***********************...\r\n" + 
			"..............................\r\n" + 
			".........*******************..\r\n" + 
			"*****.........................\r\n" + 
			"*****.***********************.\r\n" + 
			"*****.***********************.\r\n" + 
			"*****.........................\r\n" + 
			"30 30\r\n" + 
			"..............................\r\n" + 
			"..................***********.\r\n" + 
			"..................***********.\r\n" + 
			".............*....***********.\r\n" + 
			".........***.*....***********.\r\n" + 
			".....*...***.*....***********.\r\n" + 
			".....*...***.*....***********.\r\n" + 
			".....*...***.*....***********.\r\n" + 
			".....*...***.*....***********.\r\n" + 
			".....*...***.*....***********.\r\n" + 
			".....*...***.*....***********.\r\n" + 
			".....*...***.*....***********.\r\n" + 
			".....*...***.*....***********.\r\n" + 
			".....*...***.*..*.***********.\r\n" + 
			".....*...***.*..*.***********.\r\n" + 
			".......*.....*..*.***********.\r\n" + 
			"................*.***********.\r\n" + 
			"...************.*.***********.\r\n" + 
			"...************.*.***********.\r\n" + 
			"...************.*.***********.\r\n" + 
			"...************.*.***********.\r\n" + 
			"...************.*.***********.\r\n" + 
			"...************.*.***********.\r\n" + 
			"...************.*.***********.\r\n" + 
			"...************.*.............\r\n" + 
			"...************.************..\r\n" + 
			"...************.************..\r\n" + 
			"................************..\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"30 30\r\n" + 
			"******************************\r\n" + 
			"*************************.****\r\n" + 
			"..........................**..\r\n" + 
			".........................***..\r\n" + 
			".........................***..\r\n" + 
			".........................***..\r\n" + 
			"....******************...***..\r\n" + 
			"....******************...***..\r\n" + 
			"....******************...***..\r\n" + 
			"....******************...***..\r\n" + 
			"....******************...***..\r\n" + 
			"....******************...***..\r\n" + 
			"....*******.......****...***..\r\n" + 
			"....*******.......****...***..\r\n" + 
			"....*******.......****...***..\r\n" + 
			"....*******.......****...***..\r\n" + 
			"....*******.......****...***..\r\n" + 
			"....*******.......****...***..\r\n" + 
			"....*******.......****...***..\r\n" + 
			"....*******.......****...***..\r\n" + 
			"..................****...***..\r\n" + 
			".....*****************...***..\r\n" + 
			".....*****************...***..\r\n" + 
			".....*****************...***..\r\n" + 
			".....*****************...***..\r\n" + 
			"..............................\r\n" + 
			"........................***...\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"30 30\r\n" + 
			"..............................\r\n" + 
			".*............................\r\n" + 
			".*..........****************..\r\n" + 
			".*..*******.****************..\r\n" + 
			".*..*******...................\r\n" + 
			".*.........................**.\r\n" + 
			".*........*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.*.......********.**.\r\n" + 
			".*....***.........********.**.\r\n" + 
			".*.................*******.**.\r\n" + 
			".*...*************.*******.**.\r\n" + 
			".*...*************.*******.**.\r\n" + 
			".*.................*******.**.\r\n" + 
			".*.........................**.\r\n" + 
			".*............................\r\n" + 
			"..............................\r\n" + 
			"....................*********.\r\n" + 
			"...****************.*********.\r\n" + 
			".*.****************.*********.\r\n" + 
			"...****************...........\r\n" + 
			"30 30\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..............................\r\n" + 
			"..*...........................\r\n" + 
			"..*...........................\r\n" + 
			"..*...........................\r\n" + 
			"..*...........................\r\n" + 
			"..*...........................\r\n" + 
			"..............................\r\n" + 
			"..............................";
}
